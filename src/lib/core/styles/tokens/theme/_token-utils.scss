@use '../../theme/utils' as theme-utils;
@use '../../theme/color-utils';
@use './color-emphasis';

///
/// Computes the dependent theme colors from the provided theme color value.
/// 
/// @param {String} $name - The name of the theme color
/// @param {Color} $color - The theme color
/// @param {Color} $surface - The base surface color
/// @return {Map} - The computed theme map
/// 
@function get-color-theme($name, $color, $surface) {
  @if not theme-utils.is-color($color) {
    @error 'The value for "#{$name}" must be a color type.';
  }

  $surface-tone: color-utils.tone($surface);

  // The container colors are the provided color mixed with the surface color at lower emphasis levels
  $container: theme-utils.hexify($color, $surface, color-emphasis.value(low));

  // The on-color is the contrast color against the provided color
  $on-color: theme-utils.contrast($color);

  // The on-container colors are the contrast color for the provided color mixed with the
  // container color at a lower emphasis to let the contrast color bleed through for
  // increased contrast against the lower emphasis container color
  $on-container: theme-utils.hexify($color, theme-utils.contrast($container), color-emphasis.value(medium));

  // Compute contrast ratio for foreground colors against their corresponding background
  $minimum-ratio: 4.5;
  @if color-utils.contrast-ratio($color, $on-color) < $minimum-ratio {
    @warn 'The contrast ratio  between "#{$name}" and "on-#{$name}" is less than 4.5:1.';
  }
  @if color-utils.contrast-ratio($container, $on-container) < $minimum-ratio {
    @warn 'The contrast ratio  between "#{$name}-container" and "on-#{$name}-container" is less than 4.5:1.';
  }

  @return (
    #{$name}: $color,
    #{$name}-container: $container,
    on-#{$name}: $on-color,
    on-#{$name}-container: $on-container
  );
}
