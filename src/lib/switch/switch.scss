@use './core';
@use './configuration';
@use '../core/styles/tokens/switch/tokens';
@use '../focus-indicator';
@use '../state-layer';

:host {
  @include core.host;
}

:host([hidden]) {
  display: none;
}

// Off
.forge-switch {
  @include configuration.configuration;
  @include core.switch;

  --_current-state-layer-width: var(--_state-layer-width);
  --_current-state-layer-height: var(--_state-layer-height);

  .container {
    @include core.container;
  }

  .input {
    @include core.input;
  }

  .track {
    @include core.track;
  }

  .handle {
    @include core.handle;
  }

  .icon {
    @include core.icon;

    &__on {
      @include core.icon-on;
      @include core.icon-hidden;
    }

    &__off {
      @include core.icon-off-shown;
    }
  }

  .label {
    @include core.label;
  }

  .hidden {
    display: none;
  }

  ::slotted([slot=input]) {
    @include core.input;
  }
}

// On
:host([on]) {
  .track {
    @include core.track-on;
  }

  .handle {
    @include core.handle-on;

    .icon {
      &__on {
        @include core.icon-on-shown;
      }

      &__off {
        @include core.icon-hidden;
      }

    }
  }

  forge-state-layer {
    @include state-layer.provide-theme((
      color: var(--_state-layer-on-color)
    ));
  }
}

// Active
:host(:not([disabled]):not([readonly])) {
  .forge-switch {
    .container:active {
      .track {
        @include core.track-active;
      }
  
      .handle {
        @include core.handle-active;
  
        .icon {
          @include core.icon-active;
        }
      }
    }
  }
}
:host(:not([disabled]):not([readonly])[on]) {
  .forge-switch {
    .container:active {
      .track {
        @include core.track-active-on;
      }
  
      .handle {
        @include core.handle-active-on;
  
        .icon {
          @include core.icon-active-on;
        }
      }
    }
  }
}

// Dense
:host([dense]) {
  .forge-switch {
    // Set the state layer width and height for use in calculations of other properties
    --_current-state-layer-width: var(--_state-layer-dense-width);
    --_current-state-layer-height: var(--_state-layer-dense-height);
  }
}

// Disabled
:host([disabled]) {
  .forge-switch {
    @include core.switch-disabled;

    .container {
      @include core.container-disabled;
    }

    .handle {
      @include core.handle-disabled;
    }
  }
}

// Readonly
:host([readonly]) {
  .forge-switch {
    .container {
      @include core.container-disabled;
    }
  }
}

// Reduced motion
@media (prefers-reduced-motion) {
  .switch {
    --_animation-duration: 0s;
  }
}

forge-state-layer {
  @include state-layer.provide-theme((
    color: var(--_state-layer-off-color)
  ));
}

/* stylelint-disable length-zero-no-unit */
forge-focus-indicator {
  @include focus-indicator.provide-theme((
    shape: var(--_track-shape),
    outward-offset: 0px
  ));
}
/* stylelint-enable length-zero-no-unit */
